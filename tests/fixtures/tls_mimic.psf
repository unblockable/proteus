@SEGMENT.FORMATS

  DEFINE ClientHello
    { NAME: fixed; TYPE: [u8; 166] };

  DEFINE ServerHello
    { NAME: fixed; TYPE: [u8; 746] };

  DEFINE DataMsg
    { NAME: header  ; TYPE: [u8; 3] },
    { NAME: length  ; TYPE: u16 },
    { NAME: payload ; TYPE: [u8; length.size_of] };

@SEGMENT.SEMANTICS

  { FORMAT: ClientHello; FIELD: fixed;
  SEMANTIC: FIXED_BYTES(0x16030100a10100009d030352362c1012cf23628256e745e903cea696e9f62a60ba0ae8311d70dea5e41949000004c03000ff020100006f000b000403000102000a00340032000e000d0019000b000c00180009000a00160017000800060007001400150004000500120013000100020003000f0010001100230000000d002200200601060206030501050205030401040204030301030203030201020202030101000f000101) };

  { FORMAT: ServerHello; FIELD: fixed;
  SEMANTIC:
  FIXED_BYTES(0x16030300420200003e030352362c10a2665e323a2adb4b9da0c10d4a8823719272f8b4c97af24f9278481200c030010016ff01000100000b00040300010200230000000f00010116030301c30b0001bf0001bc0001b9308201b53082011e020900f4a72fd3e8fc37c4300d06092a864886f70d0101050500301f311d301b06035504030c145465737420436572746966696361746520525341301e170d3133303931353231353131305a170d3233303931333231353131305a301f311d301b06035504030c14546573742043657274696669636174652052534130819f300d06092a864886f70d010101050003818d0030818902818100ac352a937fc54f1898b29fa0fb34e6e28b9ed7469107d8488aa8438bfac0ffb7cad55f58bee42f201c3ef942f4b0279ab6b001bf9740aac42a1cac9370b48e94da38cbb45e14b6cc1966e806f299ec490c910996e69ae166e584642fa24ce321ac4275ec8ce9f6d99e40cb1d02c38c68f02b461cb32739750e2ac4d99cb6b44d0203010001300d06092a864886f70d01010505000381810067434ca8a43eeb1b3228708bdbebfef1b3703995343326ef54b622f9e1d5e6c37696e5c114615ba5c26ce7e6ef0026ecbc4827f53d736615379caa8797ef22da5851bb33e9c84644d1c99d35cc660529b4645f6de1210d4568ac064315e1c6c4c8b4fac334fd4939cb22018a303450b024557b6c6d5cf6331a6cf677a62c9a3216030300cd0c0000c9030017410497e0a14ed718a0e817bfe1a0c1ad2565fd35941be1c2df8a23dfeffbd3ede54f6104f00b732622f55905c33130f0bae0519d33a458c97c9e94adf747781df43b060100804a3959d3dbbe40327a4406e62a2bfc5dc6453219f056b4bf6077a1bedeaffb36b1032ac2a2ed12b09bad4b689bd1e0ac4aa128115ea6d14d7ac3d8cc493343eb328ad85e4fb1d9cc2efa827b2850fb7e8a0e85d76caec989c0336390469e6784402ec509e4360c35c98c4c509f6684b06e84614279201963fefa25e73fa0acb316030300040e000000)
  };

  { FORMAT: DataMsg; FIELD: header;  SEMANTIC: FIXED_BYTES(0x170303) };
  { FORMAT: DataMsg; FIELD: length;  SEMANTIC: LENGTH };
  { FORMAT: DataMsg; FIELD: payload; SEMANTIC: PAYLOAD };

@SEGMENT.SEQUENCE

  { ROLE: CLIENT; PHASE: HANDSHAKE; FORMAT: ClientHello };
  { ROLE: SERVER; PHASE: HANDSHAKE; FORMAT: ServerHello };
  { ROLE: CLIENT; PHASE: DATA;      FORMAT: DataMsg };
  { ROLE: SERVER; PHASE: DATA;      FORMAT: DataMsg };
